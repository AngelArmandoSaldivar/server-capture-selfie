(this["webpackJsonpcapture-selfie"]=this["webpackJsonpcapture-selfie"]||[]).push([[0],{11:function(e,t,o){},15:function(e,t,o){},16:function(e,t,o){"use strict";o.r(t);var n=o(2),s=o(6),c=o.n(s),a=(o(11),o(4)),i=o(3),l=o.p+"static/media/LOGO-CORE.cb87a809.jpg",r=o(0);var d=()=>{const[e,t]=Object(n.useState)([]),[o,s]=Object(n.useState)(null),[c,d]=Object(n.useState)(null),[p,h]=Object(n.useState)(""),[u,g]=Object(n.useState)(!1),[m,O]=Object(n.useState)(""),j=t=>{e.length>0&&window.location.reload(),O(t.target.value)},b=()=>{document.getElementById("fileInput").click()},f=()=>"Pasaporte"==m?null!==c?"Reemplazar Imagen":0===e.length?"CARGAR PASAPORTE":1===e.length?"CARGAR SELFIE":2===e.length?"CARGAR COMPROBANTE DE DOMICILIO":"VALIDAR DOCUMENTOS":null!==c?"Reemplazar Imagen":0===e.length?"CARGAR INE FRENTE":1===e.length?"CARGAR INE REVERSO":2===e.length?"CARGAR SELFIE":3===e.length?"CARGAR COMPROBANTE DE DOMICILIO":"VALIDAR DOCUMENTOS";function N(){if(4===e.length){const t=new Headers;t.append("Content-Type","application/json");const n=JSON.stringify({ineFront:e[0],ineBack:e[1],selfie:e[2],comprobante:e[3]});console.log("JSON: "+n);const s={method:"POST",headers:t,body:n,redirect:"follow"};console.log("FOTOS: "+n),g(!0),h("Estamos validando los documentos \n Espera un momento..."),fetch("https://server-capture-selfie-d4c65bd43858.herokuapp.com/app/verificacion",s).then((e=>e.text())).then((n=>{const s=new Headers;s.append("Content-Type","application/json");const c={method:"POST",headers:s,body:JSON.stringify({uuid:n}),redirect:"follow"};if(n){async function a(){let n=null;console.log("ENTRASTE *************"),console.log("Entraste ************** "+JSON.stringify(c));for(;!n;){0;try{const o=await fetch("https://server-capture-selfie-d4c65bd43858.herokuapp.com/app/getCustomer",c),s=await o.text();if(console.log("##########################"),console.log("RESULT: "+JSON.parse(s).identifier),console.log("##########################"),JSON.parse(s).identifier){console.log("################ ENTRASTE ####################");const o=JSON.stringify({client_body:s,comprobante:e[3],ineFront:e[0],ineBack:e[1],selfie:e[2]});return fetch("https://server-capture-selfie-d4c65bd43858.herokuapp.com/app/verificacion",{method:"POST",headers:t,body:o,redirect:"follow"}).then((e=>e.text())).then((e=>{console.log("IDENTIFIER: "+JSON.parse(s).identifier),null!=JSON.parse(s).identifier&&setTimeout((()=>{g(!1),h(e)}),3e3),console.log("RESP: "+e),n=JSON.parse(s).identifier})).catch((e=>{console.log("ERROR: "+e)})),JSON.parse(s).identifier}console.log("UUID: "+s.uuid),console.log("Entraste no existe"),await new Promise((e=>setTimeout(e,1e4)))}catch(o){console.error("Error al hacer la solicitud a la API:",o.message),h("Error al hacer la solicitud."),g(!1),await new Promise((e=>setTimeout(e,1e4)))}}return console.log("RETURN UUID: "+n),n}a().then((e=>{null!=e?console.log("Entraste uuid: "+e):console.log("AUN CARGANDO: "+e)})).catch((e=>{h(e),g(!1)}))}})).catch((e=>{h("Verificaci\xf3n Facial Fallida"),g(!1),console.log("ERR: "+e)}))}else{const t=new Headers;t.append("Content-Type","application/json");const n=JSON.stringify({ineFront:e[0],ineBack:"",selfie:e[1],comprobante:e[2]});console.log("JSON: "+n);const s={method:"POST",headers:t,body:n,redirect:"follow"};console.log("FOTOS: "+n),g(!0),h("Estamos validando los documentos \n Espera un momento..."),fetch("https://server-capture-selfie-d4c65bd43858.herokuapp.com/app/verificacion",s).then((e=>e.text())).then((n=>{const s=new Headers;s.append("Content-Type","application/json");const c={method:"POST",headers:s,body:JSON.stringify({uuid:n}),redirect:"follow"};if(n){async function a(){let n=null;console.log("ENTRASTE *************"),console.log("Entraste ************** "+JSON.stringify(c));for(;!n;){0;try{const o=await fetch("https://server-capture-selfie-d4c65bd43858.herokuapp.com/app/getCustomer",c),s=await o.text();if(console.log("##########################"),console.log("RESULT: "+JSON.parse(s).identifier),console.log("##########################"),JSON.parse(s).identifier){const o=JSON.stringify({client_body:s,comprobante:e[2],ineFront:e[0],ineBack:"",selfie:e[1]});return fetch("https://server-capture-selfie-d4c65bd43858.herokuapp.com/app/verificacion",{method:"POST",headers:t,body:o,redirect:"follow"}).then((e=>e.text())).then((e=>{null!=JSON.parse(s).identifier&&setTimeout((()=>{g(!1),h(e)}),3e3),console.log("RESP: "+e),n=JSON.parse(s).identifier})).catch((e=>{console.log("ERROR: "+e)})),JSON.parse(s).identifier}console.log("UUID: "+s.uuid),console.log("Entraste no existe"),await new Promise((e=>setTimeout(e,1e4)))}catch(o){console.error("Error al hacer la solicitud a la API:",o.message),h("Error al hacer la solicitud."),g(!1),await new Promise((e=>setTimeout(e,1e4)))}}return console.log("RETURN UUID: "+n),n}a().then((e=>{null!=e?console.log("Entraste uuid: "+e):console.log("AUN CARGANDO: "+e)})).catch((e=>{h(e),g(!1)}))}})).catch((e=>{h("Verificaci\xf3n Facial Fallida"),g(!1),console.log("ERR: "+e)}))}}return Object(r.jsxs)("div",{className:"contenedor-imagen",children:[Object(r.jsxs)("header",{className:"header",children:[Object(r.jsx)("img",{src:l,alt:"Logo",className:"logo"}),Object(r.jsx)("h1",{className:"title",children:"Verificar Documentos"})]}),Object(r.jsxs)("div",{className:"divTexto",children:[Object(r.jsx)("span",{className:"nota",children:Object(r.jsx)("b",{children:"Nota"})})," Si seleccionas un ",Object(r.jsx)("b",{children:" pasaporte"}),", no es necesario cargar el archivo del reverso"]}),Object(r.jsxs)("div",{className:"document-selector",children:[Object(r.jsx)("h3",{children:"Selecciona el tipo de documento con el que te quieres identificar"}),Object(r.jsxs)("div",{className:"checkbox-group",children:[Object(r.jsxs)("label",{children:[Object(r.jsx)("input",{type:"checkbox",value:"documento_identidad",checked:"documento_identidad"===m,onChange:j}),"Documento de identidad"]}),Object(r.jsxs)("label",{children:[Object(r.jsx)("input",{type:"checkbox",value:"Pasaporte",checked:"Pasaporte"===m,onChange:j}),"Pasaporte"]})]})]}),Object(r.jsx)("input",{id:"fileInput",type:"file",accept:"image/*",multiple:!0,onChange:o=>{const n=Array.from(o.target.files),a=n.filter((e=>e.type.startsWith("image/")&&e.size<=5242880));if(a.length!==n.length)return void s("Algunos archivos no son im\xe1genes o superan el tama\xf1o m\xe1ximo permitido de 5MB.");if(null===c){if(e.length+a.length>4)return void s("No se pueden cargar m\xe1s de 4 im\xe1genes.")}const i=a.map((e=>new Promise(((t,o)=>{const n=new FileReader;n.onloadend=()=>{const e=n.result.replace(/^data:image\/[a-z]+;base64,/,"");t(e)},n.onerror=o,n.readAsDataURL(e)}))));Promise.all(i).then((e=>{s(null),null!==c?(t((t=>{const o=[...t];return o[c]=e[0],o})),d(null)):t("Pasaporte"==m?t=>[...t,...e].slice(0,3):t=>[...t,...e].slice(0,4))})).catch((()=>{s("Error al cargar las im\xe1genes.")}))},style:{display:"none"}}),o&&Object(r.jsx)("p",{className:"error",children:o}),Object(r.jsxs)("div",{className:"imagenes-container",children:[e.map(((e,t)=>Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"image-wrapper",onClick:()=>(e=>{d(e),b()})(t),children:[Object(r.jsx)("img",{src:"data:image/jpeg;base64,".concat(e),alt:"Cargado por el usuario ".concat(t+1),className:"imagen"}),Object(r.jsx)("span",{className:"image-overlay",children:"Reemplazar"})]},t)," ",Object(r.jsx)("br",{}),Object(r.jsx)("br",{})]}))),Object(r.jsxs)("div",{className:"textoDiv",children:[p,1==u?Object(r.jsx)("img",{src:"https://codigofuente.io/wp-content/uploads/2018/09/progress.gif",alt:"loading",style:{width:"80px",height:"80px",marginRight:"10px"}}):""]})]}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),"Pasaporte"==m?Object(r.jsxs)("button",{className:"custom-file-upload",onClick:3==e.length?N:b,children:[f()+" ",e.length<=1?Object(r.jsx)(a.a,{icon:i.a}):Object(r.jsx)(a.a,{icon:i.b})]}):Object(r.jsxs)("button",{className:"custom-file-upload",onClick:4==e.length?N:b,children:[f()+" ",e.length<=1?Object(r.jsx)(a.a,{icon:i.a}):Object(r.jsx)(a.a,{icon:i.b})]})]})};o(15);const p=document.getElementById("root");c.a.render(Object(r.jsx)(d,{}),p)}},[[16,1,2]]]);
//# sourceMappingURL=main.a425c28d.chunk.js.map